---
import SpeakerCard from "../../SpeakerCard.astro";
import { getCollection } from 'astro:content';
import Button from "../../Button.astro";
import { CALL_FOR_SESSIONS } from "@/config";

const speakers = await getCollection("speakers");
---

<section class="mb-[40px] pt-10 text-center" id="speakers">
  <div class="container mx-auto relative">
    <h2 class="mb-8 text-3xl font-bold text-center">Speakers</h2>

    <div class="flex flex-wrap justify-center gap-2 sm:gap-4 md:gap-6 max-w-8xl mx-auto">
      {
        speakers.toSorted((a, b) => { return a.data.id - b.data.id }).map((speaker) => (
          <SpeakerCard 
            name={speaker.data.name}
            image={speaker.data.image}
            gameName={speaker.data.gameName}
            gameUrl={speaker.data.gameUrl}
            gameName2={speaker.data.gameName2}
            gameUrl2={speaker.data.gameUrl2}
            slug={speaker.slug}
          />
        ))
      }
    </div>

    <div class="mt-8">
      <Button background="bg-cyan-500" link={CALL_FOR_SESSIONS} target="_blank">
        Submit a session proposal
      </Button>
    </div>
  </div>
</section>

<script>
  function checkOverflow() {
    const carousel = document.querySelector('.carousel');
    const arrows = document.querySelectorAll('.carousel-arrow');
    if (carousel && arrows) {
      const hasOverflow = carousel.scrollWidth > carousel.clientWidth;
      arrows.forEach(arrow => {
        arrow.classList.toggle('hidden', !hasOverflow);
      });
    }
  }

  // Check on load and window resize
  window.addEventListener('load', checkOverflow);
  window.addEventListener('resize', checkOverflow);
</script>
