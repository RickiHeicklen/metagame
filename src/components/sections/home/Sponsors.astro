---
import { getCollection } from "astro:content";
import PartnerCard from "./PartnerCard.astro";

const sponsors = await getCollection("partners", (entry) => {
  return entry.data.type === "sponsor";
});

const platinumSponsors = sponsors.filter((s) => s.data.tier === "platinum");
const goldSponsors = sponsors.filter((s) => s.data.tier === "gold");
const silverSponsors = sponsors.filter((s) => s.data.tier === "silver");
---

<section class="mb-20 bg-dark-500 flex flex-col" id="sponsors">
  <div class="w-full flex flex-col items-center justify-center">
    <h2 class="mb-8 text-3xl font-bold">Sponsors</h2>
    
    {platinumSponsors.length > 0 && (
      <div class="w-full mb-16 flex flex-col items-center">
        <h3 class="text-2xl text-center font-bold mb-8 text-secondary-300">Platinum</h3>
        <div class="grid grid-cols-1 gap-8 max-w-2xl">
          {platinumSponsors
            .toSorted((a, b) => a.data.id - b.data.id)
            .map((sponsor) => (
              <PartnerCard
                imgClass="h-32 sm:h-40 lg:h-48 w-auto max-w-full object-contain"
                organizer={sponsor}
              />
            ))}
        </div>
      </div>
    )}

    {goldSponsors.length > 0 && (
      <div class="w-full mb-12 flex flex-col items-center">
        <h3 class="text-2xl text-center font-bold mb-8 text-yellow-400">Gold</h3>
        <div class={`grid gap-12 ${
          goldSponsors.length === 1 
            ? 'grid-cols-1 max-w-3xl' 
            : 'grid-cols-1 md:grid-cols-2 max-w-4xl'
        }`}>
          {goldSponsors
            .toSorted((a, b) => a.data.id - b.data.id)
            .map((sponsor) => (
              <PartnerCard
                imgClass="h-48 w-full lg:w-auto lg:h-64 max-w-full object-contain"
                organizer={sponsor}
              />
            ))}
        </div>
      </div>
    )}

    {silverSponsors.length > 0 && (
      <div class="w-full flex flex-col items-center">
        <h3 class="text-2xl text-center font-bold mb-2 text-gray-400">Silver</h3>
        <div class={`grid md:gap-16 ${
          silverSponsors.length === 1 
            ? 'grid-cols-1 max-w-md' 
            : silverSponsors.length === 2
            ? 'grid-cols-1 md:grid-cols-2 max-w-4xl'
            : 'grid-cols-1 md:grid-cols-2 lg:grid-cols-3 max-w-5xl'
        }`}>
          {silverSponsors
            .toSorted((a, b) => a.data.id - b.data.id)
            .map((sponsor) => (
              <PartnerCard
                imgClass="h-20 sm:h-24 md:h-28 lg:h-28 max-w-full object-contain"
                organizer={sponsor}
              />
            ))}
        </div>
      </div>
    )}
  </div>
</section> 